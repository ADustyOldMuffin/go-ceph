<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# admin

```go
import "github.com/ceph/go-ceph/rbd/admin"
```

Package admin is a convenience layer to support the administration of rbd volumes\, snapshots\, scheduling etc that is outside of the C api for librbd\.

Unlike the rbd package this API does not map to APIs provided by ceph libraries themselves\. This API is not yet stable and is subject to change\.

## Index

- [Variables](<#variables>)
- [type ImageSpec](<#type-imagespec>)
  - [func NewImageSpec(pool, namespace, image string) ImageSpec](<#func-newimagespec>)
  - [func NewRawImageSpec(spec string) ImageSpec](<#func-newrawimagespec>)
- [type Interval](<#type-interval>)
- [type LevelSpec](<#type-levelspec>)
  - [func NewLevelSpec(pool, namespace, image string) LevelSpec](<#func-newlevelspec>)
  - [func NewRawLevelSpec(spec string) LevelSpec](<#func-newrawlevelspec>)
- [type MirrorSnashotScheduleAdmin](<#type-mirrorsnashotscheduleadmin>)
  - [func (mss *MirrorSnashotScheduleAdmin) Add(l LevelSpec, i Interval, s StartTime) error](<#func-mirrorsnashotscheduleadmin-add>)
  - [func (mss *MirrorSnashotScheduleAdmin) List(l LevelSpec) ([]SnapshotSchedule, error)](<#func-mirrorsnashotscheduleadmin-list>)
  - [func (mss *MirrorSnashotScheduleAdmin) Remove(l LevelSpec, i Interval, s StartTime) error](<#func-mirrorsnashotscheduleadmin-remove>)
  - [func (mss *MirrorSnashotScheduleAdmin) Status(l LevelSpec) ([]ScheduledImage, error)](<#func-mirrorsnashotscheduleadmin-status>)
- [type RBDAdmin](<#type-rbdadmin>)
  - [func NewFromConn(conn ccom.RadosCommander) *RBDAdmin](<#func-newfromconn>)
  - [func (ra *RBDAdmin) MirrorSnashotSchedule() *MirrorSnashotScheduleAdmin](<#func-rbdadmin-mirrorsnashotschedule>)
  - [func (ra *RBDAdmin) Task() *TaskAdmin](<#func-rbdadmin-task>)
- [type ScheduleTerm](<#type-scheduleterm>)
- [type ScheduleTime](<#type-scheduletime>)
- [type ScheduledImage](<#type-scheduledimage>)
- [type SnapshotSchedule](<#type-snapshotschedule>)
- [type StartTime](<#type-starttime>)
- [type TaskAdmin](<#type-taskadmin>)
  - [func (ta *TaskAdmin) AddFlatten(img ImageSpec) (TaskResponse, error)](<#func-taskadmin-addflatten>)
  - [func (ta *TaskAdmin) AddRemove(img ImageSpec) (TaskResponse, error)](<#func-taskadmin-addremove>)
  - [func (ta *TaskAdmin) AddTrashRemove(img ImageSpec) (TaskResponse, error)](<#func-taskadmin-addtrashremove>)
  - [func (ta *TaskAdmin) Cancel(taskID string) (TaskResponse, error)](<#func-taskadmin-cancel>)
  - [func (ta *TaskAdmin) GetTaskByID(taskID string) (TaskResponse, error)](<#func-taskadmin-gettaskbyid>)
  - [func (ta *TaskAdmin) List() ([]TaskResponse, error)](<#func-taskadmin-list>)
- [type TaskRefs](<#type-taskrefs>)
- [type TaskResponse](<#type-taskresponse>)


## Variables

```go
var (
    // NoInterval indicates no specific interval.
    NoInterval = Interval("")

    // NoStartTime indicates no specific start time.
    NoStartTime = StartTime("")
)
```

## type [ImageSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/imagespec.go#L13-L15>)

ImageSpec values are used to identify an RBD image wherever Ceph APIs require an image\_spec/image\_id\_spec using image name/id and optional pool and namespace\.

```go
type ImageSpec struct {
    // contains filtered or unexported fields
}
```

### func [NewImageSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/imagespec.go#L24>)

```go
func NewImageSpec(pool, namespace, image string) ImageSpec
```

NewImageSpec is used to construct an ImageSpec given an image name/id and optional namespace and pool names\.

NewImageSpec constructs an ImageSpec to identify an RBD image and thus requires image name/id\, whereas NewLevelSpec constructs LevelSpec to identify entire pool\, pool namespace or single RBD image\, all of which requires pool name\.

### func [NewRawImageSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/imagespec.go#L41>)

```go
func NewRawImageSpec(spec string) ImageSpec
```

NewRawImageSpec returns a ImageSpec directly based on the spec string argument without constructing it from component values\.

This should only be used if NewImageSpec can not create the imagespec value you want to pass to ceph\.

## type [Interval](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L13>)

Interval of time between scheduled snapshots\. Typically in the form \<num\>\<m\,h\,d\>\. Exact content supported is defined internally on the ceph mgr\.

```go
type Interval string
```

## type [LevelSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/admin.go#L26-L28>)

LevelSpec values are used to identify RBD objects wherever Ceph APIs require a levelspec to select an image\, pool\, or namespace\.

```go
type LevelSpec struct {
    // contains filtered or unexported fields
}
```

### func [NewLevelSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/admin.go#L32>)

```go
func NewLevelSpec(pool, namespace, image string) LevelSpec
```

NewLevelSpec is used to construct a LevelSpec given a pool and optional namespace and image names\.

### func [NewRawLevelSpec](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/admin.go#L50>)

```go
func NewRawLevelSpec(spec string) LevelSpec
```

NewRawLevelSpec returns a LevelSpec directly based on the spec string argument without constructing it from component values\. This should only be used if NewLevelSpec can not create the levelspec value you want to pass to ceph\.

## type [MirrorSnashotScheduleAdmin](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L29-L31>)

MirrorSnashotScheduleAdmin encapsulates management functions for ceph rbd mirror snapshot schedules\.

```go
type MirrorSnashotScheduleAdmin struct {
    // contains filtered or unexported fields
}
```

### func \(\*MirrorSnashotScheduleAdmin\) [Add](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L44>)

```go
func (mss *MirrorSnashotScheduleAdmin) Add(l LevelSpec, i Interval, s StartTime) error
```

Add a new snapshot schedule to the given pool/image based on the supplied level spec\.

Similar To: rbd mirror snapshot schedule add \<level\_spec\> \<interval\> \<start\_time\>

### func \(\*MirrorSnashotScheduleAdmin\) [List](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L63>)

```go
func (mss *MirrorSnashotScheduleAdmin) List(l LevelSpec) ([]SnapshotSchedule, error)
```

List the snapshot schedules based on the supplied level spec\.

Similar To: rbd mirror snapshot schedule list \<level\_spec\>

### func \(\*MirrorSnashotScheduleAdmin\) [Remove](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L118-L119>)

```go
func (mss *MirrorSnashotScheduleAdmin) Remove(l LevelSpec, i Interval, s StartTime) error
```

Remove a snapshot schedule matching the supplied arguments\.

Similar To: rbd mirror snapshot schedule remove \<level\_spec\> \<interval\> \<start\_time\>

### func \(\*MirrorSnashotScheduleAdmin\) [Status](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L140>)

```go
func (mss *MirrorSnashotScheduleAdmin) Status(l LevelSpec) ([]ScheduledImage, error)
```

Status returns the status of the snapshot \(eg\. when it will next take place\) matching the supplied level spec\.

Similar To: rbd mirror snapshot schedule status \<level\_spec\>

## type [RBDAdmin](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/admin.go#L13-L15>)

RBDAdmin is used to administrate rbd volumes and pools\.

```go
type RBDAdmin struct {
    // contains filtered or unexported fields
}
```

### func [NewFromConn](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/admin.go#L20>)

```go
func NewFromConn(conn ccom.RadosCommander) *RBDAdmin
```

NewFromConn creates an new management object from a preexisting rados connection\. The existing connection can be rados\.Conn or any type implementing the RadosCommander interface\.

### func \(\*RBDAdmin\) [MirrorSnashotSchedule](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L35>)

```go
func (ra *RBDAdmin) MirrorSnashotSchedule() *MirrorSnashotScheduleAdmin
```

MirrorSnashotSchedule returns a MirrorSnashotScheduleAdmin type for managing ceph rbd mirror snapshot schedules\.

### func \(\*RBDAdmin\) [Task](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L17>)

```go
func (ra *RBDAdmin) Task() *TaskAdmin
```

Task returns a TaskAdmin type for managing ceph rbd task operations\.

## type [ScheduleTerm](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L82-L85>)

ScheduleTerm represents the interval and start time component of a snapshot schedule\.

```go
type ScheduleTerm struct {
    Interval  Interval  `json:"interval"`
    StartTime StartTime `json:"start_time"`
}
```

## type [ScheduleTime](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L151>)

ScheduleTime is the time a snapshot will occur\.

```go
type ScheduleTime string
```

## type [ScheduledImage](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L154-L157>)

ScheduledImage contains the item scheduled and when it will next occur\.

```go
type ScheduledImage struct {
    Image        string       `json:"image"`
    ScheduleTime ScheduleTime `json:"schedule_time"`
}
```

## type [SnapshotSchedule](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L89-L93>)

SnapshotSchedule contains values representing an entire snapshot schedule for an image or pool\.

```go
type SnapshotSchedule struct {
    Name        string
    LevelSpecID string
    Schedule    []ScheduleTerm
}
```

## type [StartTime](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/msschedule.go#L17>)

StartTime is the time the snapshot schedule begins\. Exact content supported is defined internally on the ceph mgr\.

```go
type StartTime string
```

## type [TaskAdmin](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L12-L14>)

TaskAdmin encapsulates management functions for ceph rbd task operations\.

```go
type TaskAdmin struct {
    // contains filtered or unexported fields
}
```

### func \(\*TaskAdmin\) [AddFlatten](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L60>)

```go
func (ta *TaskAdmin) AddFlatten(img ImageSpec) (TaskResponse, error)
```

AddFlatten adds a background task to flatten a cloned image based on the supplied image spec\.

Similar To: rbd task add flatten \<image\_spec\>

### func \(\*TaskAdmin\) [AddRemove](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L74>)

```go
func (ta *TaskAdmin) AddRemove(img ImageSpec) (TaskResponse, error)
```

AddRemove adds a background task to remove an image based on the supplied image spec\.

Similar To: rbd task add remove \<image\_spec\>

### func \(\*TaskAdmin\) [AddTrashRemove](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L88>)

```go
func (ta *TaskAdmin) AddTrashRemove(img ImageSpec) (TaskResponse, error)
```

AddTrashRemove adds a background task to remove an image from the trash based on the supplied image id spec\.

Similar To: rbd task add trash remove \<image\_id\_spec\>

### func \(\*TaskAdmin\) [Cancel](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L126>)

```go
func (ta *TaskAdmin) Cancel(taskID string) (TaskResponse, error)
```

Cancel a pending or running asynchronous task\.

Similar To: rbd task cancel \<task\_id\>

### func \(\*TaskAdmin\) [GetTaskByID](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L113>)

```go
func (ta *TaskAdmin) GetTaskByID(taskID string) (TaskResponse, error)
```

GetTaskByID returns pending or running asynchronous task using id\.

Similar To: rbd task list \<task\_id\>

### func \(\*TaskAdmin\) [List](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L101>)

```go
func (ta *TaskAdmin) List() ([]TaskResponse, error)
```

List pending or running asynchronous tasks\.

Similar To: rbd task list

## type [TaskRefs](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L22-L28>)

TaskRefs contains the action name and information about the image\.

```go
type TaskRefs struct {
    Action        string `json:"action"`
    PoolName      string `json:"pool_name"`
    PoolNamespace string `json:"pool_namespace"`
    ImageName     string `json:"image_name"`
    ImageID       string `json:"image_id"`
}
```

## type [TaskResponse](<https://github.com/ceph/go-ceph/blob/master/rbd/admin/task.go#L31-L41>)

TaskResponse contains the information about the task added on an image\.

```go
type TaskResponse struct {
    Sequence      int      `json:"sequence"`
    ID            string   `json:"id"`
    Message       string   `json:"message"`
    Refs          TaskRefs `json:"refs"`
    InProgress    bool     `json:"in_progress"`
    Progress      float64  `json:"progress"`
    RetryAttempts int      `json:"retry_attempts"`
    RetryTime     string   `json:"retry_time"`
    RetryMessage  string   `json:"retry_message"`
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
